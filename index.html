<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forceify</title>
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="devices.min.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div class="container">

            <h1>Forceify</h1>
            <p>The fastest, smartest and cross-device 3D Touch library for JavaScript</p>
		<div class="cd-iphone-6 cd-black centerize">
  <div class="cd-body">
    <div class="cd-sound"></div>
    <div class="cd-sleep"></div>
    <div class="cd-camera"></div>
    <div class="cd-ear"></div>
    <div class="cd-home"></div>
    <div class="cd-screen">
        <div id="forceMe"></div>
        <p id="forceValue">Force: 0, Deep Press:&nbsp;<span>No</span></p>
    </div>
  </div>
</div>

            <p>Grab package at <a href="https://github.com/dalisoft/Forceify" target="_blank">GitHub</a> or <a href="https://npmjs.org/package/forceify" target="_blank">NPM</a> or compiled at <a href="https://unpkg.com/forceify" target="_blank">unpkg</a>, <a href="https://npmcdn.com/forceify" target="_blank">npmcdn</a> or <a href="https://cdn.jsdelivr.net/npm/forceify" target="_blank">jsDelivr</a></p>

    </div>

	<script>
	// false check
	document.body.ontouchforcechange = function () {}


	var forceMe = document.querySelector('#forceMe');

	var registerEvent = function (elem) {
        var event;
        if (typeof Event === 'function') {
            event = new Event('touchforcechange');
        }
        else if (document.createEvent) {
            event = document.createEvent('Event');
            event.initEvent('touchforcechange', true, true);
        }
        forceMe.addEventListener('mousedown', function (_a) {
            event.force = 1;
            elem.dispatchEvent(event);
        });
        forceMe.addEventListener('mouseup', function (_a) {
            event.force = 0;
            elem.dispatchEvent(event);
        });
    };

	registerEvent(forceMe);
	</script>
    <script type="text/javascript" src="Forceify.js"></script>
	<script type="text/javascript">

	// Helpers function

	// Lerp array (simple)
	var steppize = function (force, args) {
	var m = Math.round(force * (args.length - 1))
	return args[m];
	};

	// Returns state of deep-press (aka Force Click)
	var isDeepPress = function (force) {
		return force > 0.645579000009;
	}

	// Check if there CSS3 3D-mode available?
	var is3D = 'perspective' in forceMe.style || 'webkitPerspective' in forceMe.style || 'mozPerspective' in forceMe.style || 'MsPerspective' in forceMe.style || 'msPerspective' in forceMe.style || 'OPerspective' in forceMe.style;

	var __webkitTransform = 'webkitTransform' in forceMe.style ? 'webkitTransform' : 'transform';

	// Setting cross-browser CSS3 Transform set helper
	var setTransform = function (elem, transform) {
		elem.style[__webkitTransform] = transform;
	}

	// Node selector
	var forceValue = document.querySelector('#forceValue');

	// Initialize the instance
	new Forceify(forceMe).onForce(function(ev) {
		var force = ev.force;
		var scale = 1 + (force * 1.5);
		var transform = is3D ? 'translate3d(-50%, -50%, 0) scale3d(' + scale + ', ' + scale + ', ' + scale + ')' : 'translate(-50%, -50%) scale(' + scale + ')';

		setTransform(forceMe, transform);

		var color = 'rgb(' + ((255 * force) | 0) + ', ' + 204 + ', ' + (255 - (255 * force) | 0) + ')';

		forceMe.style.backgroundColor = color;

		forceValue.innerHTML = 'Force: ' + ((force * 10000) | 0) / 10000 + ', Deep Press:&nbsp;<span style="color:' + color + ';font-weight:' + steppize(force, [100, 200, 300, 400, 500, 600, 700, 800, 900]) + '">' + (isDeepPress(force) ? 'Yes' : 'No') + '</span>';
	});
	</script>
</body>
</html>
