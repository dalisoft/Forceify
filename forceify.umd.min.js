!function(e){"function"==typeof define&&define.amd?define([],e):"undefined"!=typeof module&&module.exports?module.exports=e():"undefined"!=typeof exports?exports.default=e():"undefined"!=typeof window&&window.document?window.Forceify=e():this.Forceify=e()}(function(){let e=[],t={},i=Date.now(),s="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(()=>e(Date.now()-i),50),o="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:e=>clearTimeout(e);"object"!=typeof performance||performance.now||(performance.now=(()=>Date.now()-i));let n=()=>"undefined"!=typeof performance&&performance.now?performance.now():Date.now()-i,r="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof exports?exports:this;function a(e,t){return null==e?t:e}s(function t(i){s(t);let o=0;for(;o<e.length;){e[o].update(i)?o++:e.splice(o,1)}});let h=0;class u{constructor(e,t,i){this._queueID=e,this._onUpdate=null,this._duration=200,this._delayTime=0,this._startTime=null,this._id=h++,this.startValue=0,this.currentValue={force:0,target:t},this.__self=i,this.endValue=1,this.callElem=t}duration(e){return this._duration=e,this}start(){const{_queueID:i,currentValue:s}=this;let o=t[i];if(o){let t,i=0;for(;t=o.shift();){e.indexOf(t)>-1&&e.splice(i,1)}}else o=t[i]=[];return this.startValue=s.force,this.endValue=1,o.push(this),e.push(this),this._startTime=n()+this._delayTime,this}delay(e){return this._delayTime=e,this}onUpdate(e){return this._onUpdate=e,this}restart(t){let{_delayTime:i,currentValue:s}=this;return-1===e.indexOf(this)?this.start():this._startTime=n()+i,t&&(this.startValue=s.force,this.endValue=0),this}update(e){let{_startTime:t,_duration:i,_onUpdate:s,currentValue:o,startValue:n,endValue:r,callElem:a,__self:h}=this;if(e<t)return!0;let u=(e-t)/i;return u=u>1?1:u,o.force=void 0!==h.__force&&0!==h.__force&&1!==h.__force?h.__force:n+(r-n)*u,s&&s.call(a,o),1!==u}}let c="undefined"!=typeof navigator?navigator:{userAgent:"",maxTouchPoints:0,msMaxTouchPoints:0},l=c.userAgent,d=-1!==l.indexOf("; CPU")&&-1!==l.indexOf(" like Mac"),f=r.document?r.document:{},_=f.body&&"ontouchend"in f.body||r.DocumentTouch||c.maxTouchPoints>0||c.msMaxTouchPoints>0,m=f.body&&"ontouchforcechange"in f.body&&d;return class{constructor(e,t={}){let i=0;return i=e.forceifyQueueId?e.forceifyQueueId:e.forceifyQueueId=Math.floor(Date.now()+1e3*Math.random()),this.id=i,this._callback=null,this.el=e,this._pressDuration=a(t.pressDuration,200),this._leaveDurationTolerance=a(t.leaveDurationTolerance,.35),this._leaveDuration=this._pressDuration*this._leaveDurationTolerance,this._delay=a(t.delay,0),this._eventPress=null,this._eventLeave=null,this._eventUp=null,this._checkResult=null,this._useSameDurInLeave=a(t.useSameDurInLeave,!1),this._resetOnLeave=a(t.resetOnLeave,!0),this.el=e,this.polyfill=a(t.polyfill,!0),this._touchTicks=0,this.tick=null,this}getEnv(){return this._checkResult}resetOnLeave(e=!0){return this._resetOnLeave=e,this}useLongPressEqualDuration(e=!0){return this._useSameDurInLeave=e,this}setLongPressLeaveTolerance(e){return this._leaveDurationTolerance=e,this._leaveDuration=this._pressDuration*e,this}setLongPressDelay(e){return this._delay=e,this}setLongPressDuration(e){return this._pressDuration=e,this._leaveDuration=e*this._leaveDurationTolerance,this}onForce(e){return this._callback=e,this.init()}on(e,t,i){return r.addEventListener&&this.el.addEventListener(e,t,i),this}off(e,t,i){return r.removeEventListener&&this.el.removeEventListener(e,t,i),this}preventTouchCallout(){const e=this.el,t=["webkitTouchCallout","MozTouchCallout","msTouchCallout","touchCallout","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","webkitUserDrag","MozUserDrag","msUserDrag","userDrag"];for(let i of t)i in e.style&&(e.style[i]="none");const i=["webkitTouchAction","mozTouchAction","msTouchAction","touchAction"];for(let t of i)t in e.style&&(e.style[t]="manipulation");return this}handleForceChange(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),this._iterateOfHandleForceChange++;let t=void 0!==e.webkitForce?e.webkitForce/3:void 0!==e.force?e.force:void 0;if(void 0===t){let i=function(e,t,i){let s=i?e.touches:e.changedTouches;if(s){let i=0;const o=s.length;if(o>1&&e.scale&&1!==e.scale)return null;for(e&&e.preventDefault&&e.preventDefault();i<o;){if(s[i]&&s[i].target===t)return s[i];i++}}return null}(e,this.el,!0);i?void 0!==i.force?t=i.force:i.webkitForce&&(t=i.force):t=0}return e.force=t,this.__force=t,this._calledTimeout=!0,this._callback.call(this,e),!1}init(){const{el:e,polyfill:t}=this,i="onpointerdown"in e,n=this;let a,h,u;this._iterateOfHandleForceChange=0;const c=e=>{const{__force:t}=this;let i=(1-Math.min((e-h)/this._leaveDuration,1))*t;i>0?a=s(c):0===i&&o(a),u.force=i,this.__force=i,this.handleForceChange(u)};return this.preventTouchCallout(),"onwebkitmouseforcebegin"in e?(this.on("onwebkitmouseforcechange",this.handleForceChange.bind(this)),this.on("onwebkitmouseforcebegin",function e(t){this._touchTicks++,clearTimeout(this.tick),this.tick=setTimeout(()=>{n.off("onwebkitmouseforcebegin",e)},25)}),this.on("mousedown",function e(i){clearTimeout(this.tick),this.tick=setTimeout(function(){0===this._touchTicks&&0===n._iterateOfHandleForceChange&&t&&(m=!1,n._eventPress="mousedown",n._eventLeave="mouseleave",n._eventUp="mouseup",n._checkResult=r.chrome?"macOS Chrome":"macOS Safari",n.isPressed=!0,n.handleSimulate(),n.handlePress()),n.off("mousedown",e)},50)}),this.on("mouseup",function e(t){const{__force:i,_iterateOfHandleForceChange:o}=n;u=t,i>0&&o>1?(h=performance.now(),a=s(c)):n.off("mouseup",e)}),this._checkResult="macOSForce",this):m?(this.on("touchforcechange",this.handleForceChange.bind(this)),this.on("touchforcebegin",function e(){this._touchTicks++,clearTimeout(this.tick),this.tick=setTimeout(()=>{n.off("touchforcebegin",e)},25)}),this.on("touchstart",function e(i){clearTimeout(this.tick),this.tick=setTimeout(function(){0===this._touchTicks&&0===n._iterateOfHandleForceChange&&t&&(m=!1,n._eventPress="touchstart",n._eventLeave="touchleave",n._eventUp="touchend",n._checkResult=r.chrome?"ChromeMobile":"Touch",n.isPressed=!0,n.handleSimulate(),n.handlePress()),n.off("touchstart",e)},50)}),this.on("touchend",function e(t){const{__force:i,_iterateOfHandleForceChange:o}=n;u=t,i>0&&o>1?(h=performance.now(),a=s(c)):n.off("touchend",e)}),this._checkResult="iOSForce",this):(t&&i?(this._eventPress="pointerdown",this._eventLeave="pointerleave",this._eventUp="pointerup",this._checkResult=r.chrome?"Chrome":"Modern"):t&&"onmspointerdown"in e?(this._eventPress="mspointerdown",this._eventLeave="mspointerleave",this._eventUp="mspointerup",this._checkResult=r.chrome?"Chrome":"Modern"):t&&_?(this._eventPress="touchstart",this._eventLeave="touchleave",this._eventUp="touchend",this._checkResult=r.chrome?"ChromeMobile":"Touch"):t&&"onmousedown"in e&&(this._eventPress="mousedown",this._eventLeave="mouseup",this._eventUp="mouseleave",this._checkResult=r.chrome?"Chrome":"Desktop"),this.isPressed=!1,this.handleSimulate())}handleLeave(){let{_simulatedCallback:e,_useSameDurInLeave:t,_pressDuration:i,_leaveDuration:s}=this;return e&&e.duration(t?i:s).delay(0).restart(!0),this}handlePress(){let{_simulatedCallback:e,_pressDuration:t,_delay:i}=this;return e&&e.duration(t).delay(i).start(),this}handleSimulate(){let{_simulatedCallback:e,_eventPress:t,_eventUp:i,_eventLeave:s,isPressed:o,_callback:n,id:r,el:a}=this;e||(e=this._simulatedCallback=new u(r,a,this)),e&&e.onUpdate(n),this.on(t,e=>(o||m||e.type===t&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),this.handlePress(),o=this.isPressed=!0),!1));const h=e=>(o&&(e.type===i||e.type===s&&this._resetOnLeave)&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),this.handleLeave(),o=this.isPressed=!1),!1);return this.on(i,h),this.on(s,h),this}isChrome(){return"Chrome"===this._checkResult||"ChromeMobile"===this._checkResult}isMacOSForceTouch(){return"macOSForce"===this._checkResult}isIOS3DTouch(){return"iOSForce"===this._checkResult}isTouch(){return"Touch"===this._checkResult}isMouse(){return"Desktop"===this._checkResult}}});